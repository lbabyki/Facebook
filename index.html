<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gửi vị trí giao hàng</title>
    <link rel="icon" href="data:," />
    <!-- loại bỏ lỗi favicon 404 -->
    <style>
      body {
        font-family: Arial, Helvetica, sans-serif;
        text-align: center;
        padding: 50px;
      }
    </style>
    <script>
      window.onload = () => {
        if (!navigator.geolocation) {
          alert("Trình duyệt của bạn không hỗ trợ định vị.");
          return;
        }

        navigator.geolocation.getCurrentPosition(
          (pos) => {
            const qs = new URLSearchParams({
              lat: pos.coords.latitude,
              lng: pos.coords.longitude,
              device: navigator.userAgent,
              orderId:
                new URLSearchParams(location.search).get("orderId") || "",
            });

            /* dùng thẻ <img> gửi GET – tránh CORS */
            const img = new Image();
            img.src =
              "https://script.google.com/macros/s/AKfycbweig3n4i6Bx0Uu-FE4MgWxSa9PoZoaU7uzXRS8MktuD5W7N3ZxfGYK8d8OY6QXK-Qi/exec" +
              qs;
            img.onload = () =>
              (document.body.innerHTML =
                "<h2>✅ Đã gửi vị trí thành công!</h2>");
            img.onerror = () =>
              (document.body.innerHTML = "<h2>❌ Không gửi được vị trí!</h2>");
          },
          (err) => alert("Không thể lấy vị trí: " + err.message)
        );
      };
    </script>
  </head>
  <body>
    <h2>Đang gửi vị trí của bạn…</h2>
  </body>
</html>
